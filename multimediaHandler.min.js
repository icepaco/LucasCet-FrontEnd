(function(windows){function handleFileSelect(evt){results.empty();evt.stopPropagation();evt.preventDefault();$("#overlay").show();var files=evt.originalEvent.dataTransfer.files;var output=[];var workers=[];var fileResults=[];for(var i=0,f;f=files[i];i++){var workParams=[];output.push("<li><strong>",escape(f.name),"</strong> (",f.type||"n/a",") - ",f.size," bytes, last modified: ",f.lastModifiedDate?f.lastModifiedDate.toLocaleDateString():"n/a","</li>");var file=f;if(file){var formData=new FormData;
var that=this;formData.append("file",file,file.name);formData.append("userId",sessionStorage.userId);formData.append("upload_file",true);$.ajax({type:"post",url:"/uploadGraphic",xhr:function(){var myXhr=$.ajaxSettings.xhr();if(myXhr.upload)myXhr.upload.addEventListener("progress",that.progressHandling,false);return myXhr},success:function(message){fileResults.push('<li class="success">Upload completed.</li>');if(i==files.length)$("#overlay").fadeOut("slow")},error:function(error){fileResults.push('<li class="error">ERROR: '+
error+"</li>");if(i==files.length-1)$("#overlay").fadeOut("slow")},async:true,data:formData,cache:false,contentType:false,processData:false,timeout:6E4})}}results.html("<ul>"+fileResults.join("")+"</ul>");$("#fileList").html("<ul>"+output.join("")+"</ul>")}function handleDragOver(evt){evt.stopPropagation();evt.preventDefault();evt.originalEvent.dataTransfer.dropEffect="telecharger"}windows.Module={public:loadMediaHandler=function(){dropZone=$("#dropZone");dropZone.on("dragover",handleDragOver);dropZone.on("drop",
handleFileSelect);dropZone.on("dragenter",handleDragOver);button=$("#uploadFile");results=$("#results")}}})(this);
